# ERC‑8004 integration (signaling → enforcement)

AGIJobManager is the **on‑chain enforcement layer** for escrow, settlement, dispute resolution, and reputation mapping. ERC‑8004 provides an **off‑chain signaling layer** (identity, reputation, validation signals) that can be indexed and ranked without affecting settlement liveness.

## From signaling → enforcement (recommended pattern)

**What ERC‑8004 provides**
- Standardized trust signals (identity, reputation, validation outcomes) for off‑chain publication and indexing.

**What AGIJobManager provides**
- Enforced escrow, payouts/refunds, disputes, and reputation updates.
- Role gating via allowlists, Merkle roots, and ENS/NameWrapper/Resolver checks.

**Recommended integration pattern (no contract changes required)**
1. Publish ERC‑8004 trust signals for agents, validators, and outcomes.
2. Index/rank those signals off‑chain using a domain‑specific policy.
3. Convert policy decisions into allowlists or Merkle roots.
4. Use AGIJobManager as the settlement anchor; avoid coupling escrow liveness to off‑chain services.

**Implemented here**: validator‑gated escrow, dispute resolution, reputation mapping, ENS/Merkle role gating, and job NFT issuance.
**Not implemented here**: any on‑chain ERC‑8004 registry or trust‑signal processing.

## Adapter workflow (this repo)

This repository ships an ERC‑8004 adapter that derives feedback artifacts from AGIJobManager events.

```mermaid
flowchart LR
    A[AGIJobManager events] --> B[Adapter scripts]
    B --> C[ERC-8004 feedback files]
    C --> D[Optional submitFeedback transactions]
```

Adapter entry points:
- `scripts/erc8004/export_feedback.js`
- `scripts/erc8004/export_metrics.js`

Mapping rules live in `integrations/erc8004/adapter_spec.md` and the quickstart is in `integrations/erc8004/README.md`.

## Operational guidance

- **Signals are policy inputs**: publish and index ERC‑8004 signals to decide who can validate or which jobs to accept.
- **Keep settlement deterministic**: avoid putting external calls in critical escrow paths.
- **Document your policy**: indexer/ranker policies should be explicit for auditors and operators.

## References
- ERC‑8004 specification: https://eips.ethereum.org/EIPS/eip-8004
- ERC‑8004 deck (framing): https://github.com/MontrealAI/AGI-Alpha-Agent-v0/blob/main/docs/presentation/MONTREALAI_x_ERC8004_v0.pdf
